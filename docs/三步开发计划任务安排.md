# Ming 项目三步开发计划任务安排

## 📋 概述

本项目将分三个阶段逐步完善功能，**全部由AI开发**，可以快速迭代和并行开发：

1. **第一步**：基础NFT铸造功能（图片上传、祝福文本、定时MINT）
2. **第二步**：命理AI集成（时间选择、四柱八字计算、AI分析）
3. **第三步**：AI图片生成（提示词生成、图片生成、流程集成）

## ⚡ AI开发优势与策略

### 开发优势

- **快速开发**：AI可以快速生成代码，无需等待人工编写
- **并行开发**：可以同时开发多个功能模块，大幅缩短开发周期
- **快速迭代**：可以快速修复bug和优化代码，无需等待
- **自动化测试**：可以快速生成测试代码，提高测试覆盖率
- **持续集成**：可以快速集成和部署，缩短发布周期
- **代码一致性**：AI生成的代码风格统一，易于维护

### 开发策略

1. **模块化开发**：
   - 将功能拆分为独立模块
   - 每个模块可以并行开发
   - 模块之间通过接口通信

2. **快速原型**：
   - 先实现核心功能
   - 快速验证可行性
   - 逐步完善细节

3. **自动化测试**：
   - 每个功能模块都包含测试
   - 使用AI生成测试用例
   - 持续集成测试

4. **快速反馈**：
   - 发现问题立即修复
   - 快速优化用户体验
   - 持续改进功能

### 注意事项

虽然AI开发速度快，但仍需要：
- **功能验证**：确保功能符合需求
- **用户体验**：关注用户交互和界面设计
- **性能优化**：确保系统运行流畅
- **文档更新**：及时更新开发文档
- **代码审查**：关键功能需要人工审查

---

## 🎯 第一步：基础NFT铸造功能

### 目标
实现基础的NFT铸造功能，支持图片上传、个人祝福文本输入，以及定时MINT功能。

### 任务清单

#### 1.1 图片上传功能优化

**任务描述**：
- 优化现有的图片上传组件
- 支持多种图片格式（jpg, png, gif, webp等）
- 实现图片大小限制和压缩
- 改进图片预览功能

**技术实现**：
- 文件类型验证
- 文件大小检查（建议限制10MB）
- 图片压缩（使用browser-image-compression或类似库）
- 预览功能优化

**文件位置**：
- `srcs/src/components/ceremony/ImageUpload.tsx`（新建）
- `srcs/src/pages/NFTCeremony/index.tsx`（修改）

**预计时间**：0.5-1天（AI开发）

---

#### 1.2 祝福/祝愿文本输入功能

**任务描述**：
- 在NFT铸造流程中添加祝福文本输入字段
- 支持多行文本输入
- 文本长度限制（建议500字）
- 文本验证和格式化

**技术实现**：
- 添加TextField组件（multiline）
- 文本长度计数
- 文本验证（特殊字符检查等）
- 文本格式化（去除多余空格等）

**文件位置**：
- `srcs/src/pages/NFTCeremony/index.tsx`（修改）
- `srcs/src/types/nft.ts`（修改，添加祝福文本字段）

**预计时间**：0.5天（AI开发）

---

#### 1.3 NFT元数据Schema更新

**任务描述**：
- 更新NFT元数据Schema，包含祝福文本
- 添加定时MINT相关信息（如需要）
- 确保向后兼容

**技术实现**：
```typescript
interface NFTMetadata {
  name: string;
  description: string;
  image: string;
  attributes: Attribute[];
  blessing?: {
    text: string;
    timestamp: string;
  };
  scheduledMint?: {
    scheduledTime: string;
    mintedTime?: string;
  };
  // ... 其他字段
}
```

**文件位置**：
- `srcs/src/types/nft.ts`（修改）
- `srcs/src/services/contract/nftContract.ts`（修改）

**预计时间**：0.5天（AI开发）

---

#### 1.4 定时MINT功能 - 时间选择器

**任务描述**：
- 实现时间选择器组件
- 支持日期和时间选择
- 验证不能选择过去的时间
- 时区处理

**技术实现**：
- 使用Material-UI的DateTimePicker或自定义组件
- 日期验证逻辑
- 时区转换（UTC/本地时间）
- 时间格式化

**文件位置**：
- `srcs/src/components/ceremony/DateTimePicker.tsx`（新建）
- `srcs/src/utils/dateTime.ts`（新建，时间处理工具）

**预计时间**：0.5-1天（AI开发）

---

#### 1.5 定时MINT功能 - 任务调度系统

**任务描述**：
- 设计定时任务数据结构
- 实现定时任务创建功能
- 实现定时任务存储（localStorage或IndexedDB）
- 实现定时任务执行机制

**技术实现**：
```typescript
interface ScheduledMintTask {
  id: string;
  image: File;
  blessing: string;
  scheduledTime: string; // ISO 8601格式
  metadata: NFTMetadata;
  status: 'pending' | 'processing' | 'completed' | 'failed';
  createdAt: string;
  mintedAt?: string;
  txHash?: string;
  tokenId?: string;
}
```

**执行机制选择**：
- **方案A**：前端轮询（使用setInterval检查待执行任务）
- **方案B**：后端服务（需要部署定时任务服务）
- **推荐**：第一步使用方案A，后续可升级为方案B

**文件位置**：
- `srcs/src/services/scheduledMint/scheduledMintService.ts`（新建）
- `srcs/src/store/slices/scheduledMintSlice.ts`（新建）
- `srcs/src/hooks/useScheduledMint.ts`（新建）

**预计时间**：1-2天（AI开发）

---

#### 1.6 定时MINT功能 - 任务管理界面

**任务描述**：
- 创建定时任务列表页面
- 支持查看、编辑、取消定时任务
- 显示任务状态和执行结果
- 任务提醒功能（可选）

**技术实现**：
- 任务列表组件
- 任务详情展示
- 任务操作（编辑、取消）
- 状态指示器
- 通知提醒（使用浏览器Notification API）

**文件位置**：
- `srcs/src/pages/ScheduledMints/index.tsx`（新建）
- `srcs/src/components/scheduledMint/ScheduledMintList.tsx`（新建）
- `srcs/src/components/scheduledMint/ScheduledMintCard.tsx`（新建）

**预计时间**：0.5-1天（AI开发）

---

#### 1.7 NFT铸造流程整合

**任务描述**：
- 整合祝福文本到铸造流程
- 整合定时MINT到铸造流程
- 更新UI流程，简化操作步骤
- 优化用户体验

**技术实现**：
- 更新NFTCeremony页面
- 添加祝福文本输入步骤
- 添加定时MINT选项
- 流程优化（减少步骤或合并步骤）

**文件位置**：
- `srcs/src/pages/NFTCeremony/index.tsx`（修改）

**预计时间**：0.5-1天（AI开发）

---

#### 1.8 测试和优化

**任务描述**：
- 编写单元测试
- 编写集成测试
- 性能优化
- 错误处理完善
- 用户体验优化

**预计时间**：1-2天（AI开发）

---

### 第一步总结

**总预计时间**：5-7天（AI开发，包含测试和优化）

**关键里程碑**：
1. ✅ 图片上传功能优化完成
2. ✅ 祝福文本功能完成
3. ✅ 定时MINT功能完成
4. ✅ 任务管理界面完成
5. ✅ 测试和优化完成

**验收标准**：
- 用户可以上传图片并输入祝福文本
- 用户可以创建定时MINT任务
- 定时任务可以正确执行并铸造NFT
- 用户可以查看和管理定时任务

---

## 🔮 第二步：命理AI集成

### 目标
集成命理AI服务，支持时间日期选择，自动计算四柱八字，提供命理分析和推荐时间建议。

### 任务清单

#### 2.1 命理AI服务选择

**任务描述**：
- 调研可用的命理AI服务
- 评估服务质量和成本
- 选择最适合的服务
- 设计API接口

**可选服务**：
- 自建服务（需要开发）
- 第三方API（需要评估）
- 开源库（需要集成）

**预计时间**：1-2天（AI开发，主要是服务调研和选择）

---

#### 2.2 时间日期选择器增强

**任务描述**：
- 增强时间选择器，支持农历
- 实现农历/公历转换
- 时区处理
- 时间验证（不能选择过去时间）

**技术实现**：
- 使用农历转换库（如lunar-javascript）
- 日期选择器组件增强
- 时区处理工具

**文件位置**：
- `srcs/src/components/ceremony/DateTimePicker.tsx`（修改）
- `srcs/src/utils/lunar.ts`（新建，农历转换工具）

**预计时间**：1-2天（AI开发）

---

#### 2.3 四柱八字自动计算

**任务描述**：
- 根据选择的日期时间自动计算四柱八字
- 计算年柱、月柱、日柱、时柱
- 显示四柱八字结果

**技术实现**：
- 四柱八字计算算法
- 天干地支映射
- 节气计算（用于月柱）

**文件位置**：
- `srcs/src/services/astrology/fourPillarsService.ts`（新建）
- `srcs/src/utils/fourPillars.ts`（新建，四柱八字计算工具）

**预计时间**：2-3天（AI开发）

---

#### 2.4 命理AI服务集成

**任务描述**：
- 集成命理AI API
- 实现请求/响应处理
- 错误处理和降级方案
- 缓存策略

**技术实现**：
- API客户端封装
- 请求参数构建
- 响应数据解析
- 错误处理
- 缓存机制（避免重复计算）

**文件位置**：
- `srcs/src/services/astrology/astrologyAIService.ts`（新建）
- `srcs/src/types/astrology.ts`（新建，命理分析数据类型）

**预计时间**：2-3天（AI开发）

---

#### 2.5 命理分析结果展示

**任务描述**：
- 设计命理分析结果展示组件
- 显示能量分析结果
- 显示推荐时间建议
- 显示吉时选择

**技术实现**：
- 结果展示组件
- 数据可视化（可选）
- 推荐时间列表
- 吉时高亮显示

**文件位置**：
- `srcs/src/components/astrology/AstrologyResult.tsx`（新建）
- `srcs/src/components/astrology/RecommendedTimes.tsx`（新建）

**预计时间**：1-2天（AI开发）

---

#### 2.6 推荐时间功能

**任务描述**：
- 基于命理分析结果推荐最佳时间
- 支持多个推荐时间
- 显示推荐理由
- 允许用户选择推荐时间

**技术实现**：
- 推荐算法（基于命理分析结果）
- 推荐时间列表
- 推荐理由展示
- 时间选择集成

**文件位置**：
- `srcs/src/services/astrology/timeRecommendationService.ts`（新建）

**预计时间**：1-2天（AI开发）

---

#### 2.7 流程整合

**任务描述**：
- 将命理AI功能整合到NFT铸造流程
- 添加时间选择步骤
- 添加命理分析步骤
- 优化用户体验

**技术实现**：
- 更新NFTCeremony页面流程
- 添加时间选择步骤
- 添加命理分析步骤
- 流程优化

**文件位置**：
- `srcs/src/pages/NFTCeremony/index.tsx`（修改）

**预计时间**：0.5-1天（AI开发）

---

#### 2.8 测试和优化

**任务描述**：
- 编写单元测试
- 编写集成测试
- 性能优化
- 错误处理完善

**预计时间**：1-2天（AI开发）

---

### 第二步总结

**总预计时间**：8-12天（AI开发，包含测试和优化）

**关键里程碑**：
1. ✅ 命理AI服务选择完成
2. ✅ 时间选择功能完成
3. ✅ 四柱八字计算完成
4. ✅ AI服务集成完成
5. ✅ 推荐时间功能完成
6. ✅ 测试和优化完成

**验收标准**：
- 用户可以选择日期时间（支持农历）
- 系统可以自动计算四柱八字
- 系统可以提供命理分析
- 系统可以推荐最佳时间
- 用户可以基于推荐时间创建定时MINT任务

---

## 🎨 第三步：AI图片生成

### 目标
集成AI图片生成服务，基于命理分析和祝福文本自动生成图片，或辅助用户生成图片。

### 任务清单

#### 3.1 AI图片生成服务选择

**任务描述**：
- 调研可用的AI图片生成服务
- 评估服务质量和成本
- 选择最适合的服务
- 设计API接口

**可选服务**：
- DALL-E（OpenAI）
- Midjourney（需要API）
- Stable Diffusion（开源，可自建）
- 其他服务

**预计时间**：1-2天（AI开发，主要是服务调研和选择）

---

#### 3.2 提示词生成功能

**任务描述**：
- 基于命理分析结果生成提示词
- 基于祝福文本生成提示词
- 提示词模板系统
- 提示词优化和调整

**技术实现**：
- 命理元素到视觉元素的映射
- 祝福文本到视觉描述的转换
- 提示词模板库
- 提示词组合和优化

**提示词生成逻辑**：
```typescript
interface PromptGeneration {
  // 基于命理分析
  astrologyElements: {
    element: string; // 五行属性
    energy: string; // 能量类型
    // ... 其他命理元素
  };
  
  // 基于祝福文本
  blessing: {
    text: string;
    keywords: string[]; // 提取的关键词
  };
  
  // 生成的提示词
  prompt: string;
  negativePrompt?: string; // 负面提示词
}
```

**文件位置**：
- `srcs/src/services/aiImage/promptGenerationService.ts`（新建）
- `srcs/src/utils/promptTemplates.ts`（新建，提示词模板）

**预计时间**：2-3天（AI开发）

---

#### 3.3 AI图片生成功能

**任务描述**：
- 集成AI图片生成API
- 实现图片生成请求
- 实现生成进度跟踪
- 实现生成结果处理

**技术实现**：
- API客户端封装
- 请求参数构建
- 进度跟踪（轮询或WebSocket）
- 结果处理（下载、保存）

**文件位置**：
- `srcs/src/services/aiImage/aiImageGenerationService.ts`（新建）
- `srcs/src/types/aiImage.ts`（新建，AI图片生成数据类型）

**预计时间**：2-3天（AI开发）

---

#### 3.4 图片生成参数配置

**任务描述**：
- 设计图片生成参数配置界面
- 支持调整生成参数（尺寸、风格、质量等）
- 参数预设功能

**技术实现**：
- 参数配置组件
- 参数验证
- 参数预设管理

**文件位置**：
- `srcs/src/components/aiImage/ImageGenerationConfig.tsx`（新建）

**预计时间**：0.5-1天（AI开发）

---

#### 3.5 生成进度跟踪

**任务描述**：
- 实现生成进度展示
- 显示预计完成时间
- 支持取消生成

**技术实现**：
- 进度条组件
- 进度更新机制
- 取消功能

**文件位置**：
- `srcs/src/components/aiImage/GenerationProgress.tsx`（新建）

**预计时间**：0.5-1天（AI开发）

---

#### 3.6 生成结果展示和选择

**任务描述**：
- 展示生成的图片
- 支持多张图片选择
- 支持重新生成
- 支持图片编辑（可选）

**技术实现**：
- 图片展示组件
- 图片选择功能
- 重新生成功能
- 图片下载功能

**文件位置**：
- `srcs/src/components/aiImage/GeneratedImageGallery.tsx`（新建）

**预计时间**：1-2天（AI开发）

---

#### 3.7 完整流程集成

**任务描述**：
- 将AI图片生成整合到完整流程
- 支持多种流程：
  - 时间选择 → 命理分析 → AI图片生成 → NFT铸造
  - 直接上传图片 → NFT铸造
  - AI生成图片 + 用户上传图片 → 合成 → NFT铸造

**技术实现**：
- 流程路由设计
- 流程状态管理
- 流程优化

**文件位置**：
- `srcs/src/pages/NFTCeremony/index.tsx`（修改）
- `srcs/src/pages/AIImageGeneration/index.tsx`（新建，可选）

**预计时间**：2-3天（AI开发）

---

#### 3.8 成本控制和优化

**任务描述**：
- 实现调用频率限制
- 实现用户配额管理
- 实现缓存策略（避免重复生成）
- 成本监控

**技术实现**：
- 配额管理系统
- 缓存机制
- 成本统计
- 限流机制

**文件位置**：
- `srcs/src/services/aiImage/quotaService.ts`（新建）

**预计时间**：1-2天（AI开发）

---

#### 3.9 测试和优化

**任务描述**：
- 编写单元测试
- 编写集成测试
- 性能优化
- 错误处理完善
- 成本优化

**预计时间**：1-2天（AI开发）

---

### 第三步总结

**总预计时间**：10-15天（AI开发，包含测试和优化）

**关键里程碑**：
1. ✅ AI图片生成服务选择完成
2. ✅ 提示词生成功能完成
3. ✅ AI图片生成功能完成
4. ✅ 完整流程集成完成
5. ✅ 成本控制完成
6. ✅ 测试和优化完成

**验收标准**：
- 系统可以基于命理分析和祝福文本生成提示词
- 系统可以调用AI服务生成图片
- 用户可以查看和选择生成的图片
- 生成的图片可以用于NFT铸造
- 成本控制在合理范围内

---

## 📊 总体时间估算（AI开发）

| 阶段 | 预计时间 | 关键里程碑 | 说明 |
|------|---------|-----------|------|
| 第一步 | 5-7天 | 基础NFT铸造功能完成 | 包含测试和优化 |
| 第二步 | 8-12天 | 命理AI集成完成 | 包含服务选择和集成 |
| 第三步 | 10-15天 | AI图片生成完成 | 包含成本优化 |
| **总计** | **23-34天** | 约1个月 | 约3-5周 |

### 时间对比

| 开发方式 | 第一步 | 第二步 | 第三步 | 总计 |
|---------|--------|--------|--------|------|
| 传统开发 | 16-22天 | 25-34天 | 28-38天 | 69-94天 |
| **AI开发** | **5-7天** | **8-12天** | **10-15天** | **23-34天** |
| **效率提升** | **约3倍** | **约2.5倍** | **约2.5倍** | **约2.7倍** |

---

## 🎯 优先级说明

1. **第一步是基础**：必须完成第一步的所有功能，才能进行后续步骤
2. **第二步依赖第一步**：命理AI功能需要与NFT铸造流程整合
3. **第三步依赖前两步**：AI图片生成需要命理分析和NFT铸造流程

---

## 📝 注意事项（AI开发）

1. **开发策略**：
   - **并行开发**：可以同时开发多个功能模块，提高效率
   - **快速迭代**：发现问题立即修复，无需等待
   - **自动化测试**：AI可以快速生成测试代码，提高测试覆盖率
   - **持续集成**：可以快速集成和部署，缩短发布周期

2. **技术选型**：
   - 定时任务：第一步使用前端轮询，后续可升级为后端服务
   - 命理AI：需要选择合适的服务或自建（AI可以快速集成）
   - AI图片生成：需要选择合适的服务，考虑成本（AI可以快速评估和选择）

3. **成本控制**：
   - AI服务调用需要控制成本
   - 实现缓存和配额管理（AI可以快速实现）
   - 监控使用情况（AI可以快速搭建监控）

4. **用户体验**：
   - 每个步骤都要有清晰的反馈（AI可以快速优化UI）
   - 错误处理要友好（AI可以快速改进）
   - 加载状态要明确（AI可以快速添加）

5. **测试**：
   - 每个功能都要有测试（AI可以快速生成测试代码）
   - 集成测试要覆盖完整流程（AI可以快速编写）
   - 性能测试要关注AI服务调用（AI可以快速优化）

6. **文档**：
   - 及时更新开发文档（AI可以自动更新）
   - 记录技术决策（AI可以快速记录）
   - 编写用户指南（AI可以快速生成）

7. **质量控制**：
   - 虽然AI开发速度快，但仍需要人工审查关键功能
   - 重点测试核心业务流程
   - 关注用户体验和性能
   - 及时修复发现的问题

---

---

## 🚀 开发执行建议

### 第一步执行顺序（5-7天）

**第1-2天**：基础功能开发
- 图片上传功能优化（0.5-1天）
- 祝福文本输入功能（0.5天）
- NFT元数据Schema更新（0.5天）

**第3-4天**：定时MINT功能
- 时间选择器组件（1天）
- 任务调度系统（1-2天）

**第5天**：任务管理和流程整合
- 任务管理界面（0.5-1天）
- 流程整合（0.5-1天）

**第6-7天**：测试和优化
- 测试编写（1-2天）
- 性能优化和bug修复（1天）

### 第二步执行顺序（8-12天）

**第1-2天**：服务选择和基础功能
- 命理AI服务选择（1-2天）
- 时间选择器增强（1-2天）

**第3-5天**：核心功能开发
- 四柱八字计算（2-3天）
- 命理AI服务集成（2-3天）

**第6-7天**：结果展示和推荐
- 命理分析结果展示（1-2天）
- 推荐时间功能（1-2天）

**第8-9天**：流程整合
- 流程整合（0.5-1天）
- 测试和优化（1-2天）

### 第三步执行顺序（10-15天）

**第1-2天**：服务选择
- AI图片生成服务选择（1-2天）

**第3-5天**：核心功能开发
- 提示词生成功能（2-3天）
- AI图片生成功能（2-3天）

**第6-7天**：界面和配置
- 图片生成参数配置（0.5-1天）
- 生成进度跟踪（0.5-1天）
- 生成结果展示（1-2天）

**第8-10天**：流程整合和优化
- 完整流程集成（2-3天）
- 成本控制和优化（1-2天）

**第11-15天**：测试和优化
- 测试编写（1-2天）
- 性能优化和bug修复（1-2天）

---

## 📈 进度跟踪

建议使用以下方式跟踪进度：

1. **每日检查**：
   - 检查当日任务完成情况
   - 记录遇到的问题
   - 更新任务状态

2. **里程碑检查**：
   - 每个阶段结束时检查里程碑
   - 验证验收标准
   - 准备下一阶段

3. **持续优化**：
   - 根据实际情况调整时间估算
   - 优化开发流程
   - 改进代码质量

---

**文档创建时间**：2025-01-31
**最后更新**：2025-01-31（AI开发版本）
**维护者**：项目团队
**开发方式**：全部由AI开发